# SSH 服务搭建
	- ssh是一种用于安全访问远程服务的网络协议，他将客户端于服务端之间的消息通过加密保护起来，取得一定安全作用


## 为什么需要需要ssh服务
	- 应用广泛
	- 区别在于telenet，ftp安全性考虑
	- 加密


## 对称加密和非对称
	
	- 对称加密
		- 在对称加密中，客户端和服务端使用同一个密钥对数据进行加密和解密
		- 优点
			- 加密强度大，破解难
	    - 缺点
		    - 密钥本身存在安全因素
			- 密钥本身存在泄密的可能性
			- 非对称加密
			- 
	- 非对称加密
		- 在非对称加密中有俩个密钥，公钥密钥，这个密钥配对产生和使用，用公钥加密数据，必须用相对应的私钥才能解开，私钥无法通过公钥来获取，公钥可以被公开，私钥必须安全保存
		- 
		- 
		- 非对称加密工作流程
			- 服务端接受到远程客户端额登陆请求，将自己的公钥发送给客户端
			- 客户端利用这个公钥对数据进行加密
			- 客户端将加密的信息发送给服务端
			- 服务端利用自己的私钥进行解密，验证其合法性
			- 验证结果返回客户端响应
			- 
		
	- 解决问题
		- 基于口令的认证
			-  第一次登陆需要确认真实性，但是知道你的公钥指纹，问你是否继续
			-  确认后主机会被追加到known_hosts文件中

		- 基于公钥的认证
			1. client将自己的公钥手动存放在server上，追加至authorized_keys文件中
			2. server收到client的连接请求，会在authorized_keys匹配得到公钥，并生成随机数R，用客户端给的公钥对R进行加密发送给客户端
			3. client通过自己的私钥对得到的随机数R进行解密，然后对随机数R和本次会话的sessionkey利用MD5生成摘要Digest1，发送给server
			4. server也会对R和Sessionkey利用md5得到摘要Digest2
			5. server最后比较Digest1和Digest2是否相等


		- 密钥协商算法
			- 通过 Diffie-Hellman算法来实现，具体过程
				- 服务端和客户端共同选定一个大素数，叫做种子值
				- 服务端和客户端各自独立选择另外一个只有自己才知道的的素数
				- 双方使用相同的加密算法（AES），由种子值和各自私有的素数生成一个密钥值，并将这个值发送给对方
				- 在收到密钥后，服务端和客户端根据种子值和自己的私有素数，计算出一个最终的密钥（双方各自运行，但最终结果一致）
				- 双方使用上上一步得到的结果作为密钥来加密和解密通信内容



## 基本用法
	- 使用某个用户登陆远程主机
		- ssh user@host
	- 如果本地用户和远程用户名一致，则可以省略用户名
		- ssh host
	- ssh的默认端口为22，-p  22   端口可修改
		- ssh -p 端口号  user@host



	- 免密登陆
		- 产生私钥密钥对
			- sshp-keygen -t rsa
				- -t 指定密钥类型（rsa,dsa,ecdsa）
				- -f 指定存放密钥的文件（默认家目录下的.ssh目录中）
				- -p 用于确保密钥安全  passphrase    （有待考究）
		- 一路回车就行
		- 结束后生成 $HOME/.ssh/产生俩个文件   id_rsa.pub,id_rsa

		- 利用 ssh-copy-id  address 将公钥扔到服务端
			- 第一次登陆需要密码
			- 若执行失败，请把一下三行注释去啦
				- RSAAuthentication yes
				- PubkeyAuthentication yes
				- AuthorizedKeysFile      .ssh/authorized_keys
			- 修改完成配置文件请重启服务 sshd

	- 利用别名管理登陆ssh主机
		- config 管理多个免密的ssh会话  ~/.ssh/config
		- Host    tlxy
        	HostName        192.168.0.10
        	Port            22
        	User            root
        	IdentityFile    ~/.ssh/id_rsa



## ssh配置文件

	- http://blog.51cto.com/3381847248/2066599